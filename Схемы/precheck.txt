@startuml

participant "Ядро платёжного шлюза"
participant "Адаптер биллинга"
participant "Продуктовый каталог"
participant "Биллинг"


"Ядро платёжного шлюза" -> "Адаптер биллинга": Precheck
activate "Ядро платёжного шлюза"
activate "Адаптер биллинга"

opt Если задана услуга
"Адаптер биллинга" -> "Адаптер биллинга":Mapping услуги ПС\nна услугу+тариф биллинга

"Адаптер биллинга" -> "Продуктовый каталог": Получение доступных услуг и тарифов
activate "Продуктовый каталог"
"Продуктовый каталог" -> "Адаптер биллинга": Список доступных услуг и тарифов
deactivate "Продуктовый каталог"

"Адаптер биллинга" -> "Адаптер биллинга": Выбор услуги и тарифа 
end

"Адаптер биллинга" -> "Биллинг": Определение типа абонента
activate "Биллинг"
"Биллинг" -> "Адаптер биллинга": Тип абонента
deactivate "Биллинг"

"Адаптер биллинга" -> "Ядро платёжного шлюза": Precheck выполнен

deactivate "Ядро платёжного шлюза"
deactivate "Адаптер биллинга"

@enduml