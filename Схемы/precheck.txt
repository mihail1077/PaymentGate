@startuml

participant "Ядро платёжного шлюза"
participant "Адаптер биллинга"
participant "Продуктовый каталог"
participant "Биллинг"


"Ядро платёжного шлюза" -> "Адаптер биллинга": Precheck
activate "Ядро платёжного шлюза"
activate "Адаптер биллинга"

opt Если задана услуга
"Адаптер биллинга" -> "Адаптер биллинга":Mapping услуги ПС\nна услугу+тариф биллинга
opt Невозможно однозначно определить услугу
"Адаптер биллинга" -> "Продуктовый каталог": Получение доступных услуг
activate "Продуктовый каталог"
"Продуктовый каталог" -> "Адаптер биллинга": Список доступных услуг
deactivate "Продуктовый каталог"
end
end

"Адаптер биллинга" -> "Биллинг": Определение лицевого счёта
activate "Биллинг"
"Биллинг" -> "Адаптер биллинга": Лицевой счёт определён
deactivate "Биллинг"

"Адаптер биллинга" -> "Биллинг": Определение типа абонента
activate "Биллинг"
"Биллинг" -> "Адаптер биллинга": Тип абонента
deactivate "Биллинг"

"Адаптер биллинга" -> "Биллинг": Проверка доступности тарифа
activate "Биллинг"
"Биллинг" -> "Адаптер биллинга": Тариф доступен
deactivate "Биллинг"

"Адаптер биллинга" -> "Ядро платёжного шлюза": Precheck выполнен

deactivate "Ядро платёжного шлюза"
deactivate "Адаптер биллинга"

@enduml