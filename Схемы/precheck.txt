@startuml

participant "Платёжный шлюз"
participant "CRM"
participant "Биллинг абонента"
participant "Продуктовый каталог"

"Платёжный шлюз" -> "CRM": Определение лицевого счёта
activate "Платёжный шлюз"
activate "CRM"
"CRM" -> "Платёжный шлюз": Лицевой счёт определён
deactivate "CRM"

"Платёжный шлюз" -> "Биллинг абонента": Проверка лицевого счёта
activate "Биллинг абонента"
"Биллинг абонента" -> "Платёжный шлюз": Лицевой счёт проверен
deactivate "Биллинг абонента"

opt Если задана услуга
"Платёжный шлюз" -> "Продуктовый каталог": Определение стоимости услуги
activate "Продуктовый каталог"
"Продуктовый каталог" -> "Платёжный шлюз": Стоимость услуги
deactivate "Продуктовый каталог"
end

deactivate "Платёжный шлюз"

@enduml