@startuml

class "Корзина"{
Идентификатор корзины: BigDecimal
Состояние: Состояние корзины
Идентификатор абонента : String
Дата создания: DateTime
Дата оплаты: DateTime
.. Данные ПС ..
Идентификатор платежа партнёра : Int64
Дата платежа в АС партнёра: DateTimeTZ
}

note left of "Корзина"
enum "Состояние корзины"
Создана
Оплачена
Ошибка при создании
Отменена
end note

class "Позиция корзины"{
Код услуги: Integer
Сумма: Currency
Идентификатор позиции: BigDecimal
Состояние: Состояние позиции
.. Данные Биллинга ..
Лицевой счёт: String
Дата учёта в биллинге: DateTime
Номер платежа в биллинге: BigDecimal
}

note left of "Позиция корзины"
enum "Состояние позиции"
Создана
Готова к зачислению
Зачислена
Ошибка при зачислении
end note

"Платёжная система" -- "Корзина": создана для
"Платёжная система" -- "Пакет сверки": получен от

class "Платёжная система"{
Идентификатор: Integer
Наименование: string
Признак блокировки: Boolean
.. Настройки сверки ..
Допроведение при сверке: Boolean
Сверяемые атрибуты: array of <<Атрибуты>>
}

note right of  "Платёжная система"
enum "Атрибуты"
ID абнента
Код услуги
Сумма
Идентификатор корзины
Дата оплаты
Идентификатор платежа партнёра
Дата платежа в АС партнёра
end note


class "Пакет сверки"{
Дата начала периода: DateTimeTZ
Дата окончания периода: DateTimeTZ
Состояние: Состояние пакета сверки
}
note right of "Пакет сверки"
enum "Состояние пакета сверки"
Создан
Ошибочный пакет
Требуется допроведение
Сверен
Предоставлен отчёт
end note

class "Расхождение сверки"{
Тип расхождения: Тип расхождения
Источник расхождения: Источник расхождения
Идентификатор абонента : String
Сумма: Currency
Код услуги: Integer
Идентификатор корзины: BigDecimal
Дата оплаты: DateTime
Идентификатор платежа партнёра : Int64
Дата платежа в АС партнёра: DateTimeTZ
}

note right of "Расхождение сверки"
enum "Тип расхождения"
Отсутствует в реестре
Отсутствует в ПШ
Расхождение в атрибутах

enum "Источник расхождения"
Платёжный шлюз
Партнёр
end note

"Корзина" *-- "Позиция корзины"
"Пакет сверки" *-- "Расхождение сверки"
"Расхождение сверки" .. Корзина

@enduml