@startuml

class "Платёж" {
Идентификатор платежа: BigDecimal
Состояние: Состояние платежа
Лицевой счёт: String
Дата учёта в биллинге: DateTime
Номер платежа в биллинге: BigDecimal
}

note top of  "Платёж"
enum "Состояние платежа"
Создан
Выполнен
Ошибка при зачислении
end note

class "Корзина"{
Идентификатор корзины: BigDecimal
Состояние: Состояние корзины
Идентификатор абонента : String
Дата создания: DateTime
Дата оплаты: DateTime
.. Данные ПС ..
Идентификатор платежа партнёра : Int64
Дата платежа в АС партнёра: DateTimeTZ
}

note top of  "Корзина"
enum "Состояние корзины"
Создана
Оплачена
Ошибка при создании
Отменена
end note

class "Позиция корзины"{
Сумма позициии: Currency
}


"Платёжная система" -- "Корзина": создана для
"Платёжная система" -- "Пакет сверки": получен от

class "Платёжная система"{
Идентификатор: Integer
Наименование: string
Признак блокировки: Boolean
}

class "Пакет сверки"{
Дата начала периода: DateTimeTZ
Дата окончания периода: DateTimeTZ
Состояние: Состояние пакета сверки
}
note right of "Пакет сверки"
enum "Состояние пакета сверки"
Создан
Ошибочный пакет
Сверен
end note

class "Расхождение сверки"{
Тип расхождения: Тип расхождения
Источник расхождения: Источник расхождения
Идентификатор абонента : String
Сумма: Currency
Идентификатор платежа: BigDecimal
Идентификатор платежа партнёра : Int64
Дата платежа в АС партнёра: DateTimeTZ
}

note right of "Расхождение сверки"
enum "Тип расхождения"
Отсутствует в реестре
Отсутствует в ПШ
Расхождение в атрибутах

enum "Источник расхождения"
Платёжный шлюз
Партнёр
end note


class Услуга{
Код услуги: Integer
Наименование услуги: String
}

"Позиция корзины" o-- Услуга
"Корзина" *-- "Позиция корзины"
Платёж -- "Позиция корзины"
"Пакет сверки" *-- "Расхождение сверки"
"Расхождение сверки" o-- Услуга

@enduml