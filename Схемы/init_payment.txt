@startuml

participant "Инициатор платежа"
participant "Платёжный шлюз"
participant "Адаптер биллинга"

"Инициатор платежа" -> "Платёжный шлюз": Регистрация корзины
activate "Инициатор платежа"
activate "Платёжный шлюз"

loop Для каждой услуги из корзины
"Платёжный шлюз" -> "Адаптер биллинга": Проверка возможности совершения платежа(Precheck)
activate "Адаптер биллинга"
"Адаптер биллинга" -> "Платёжный шлюз": Проверка выполнена
deactivate "Адаптер биллинга"
end

opt Если задан контактный телефон
"Платёжный шлюз" -> "Адаптер биллинга": Регистрация контрактной информации
end

"Платёжный шлюз" -> "Платёжный шлюз": Сохранение информации о корзине
"Платёжный шлюз" -> "Инициатор платежа": Корзина зарегистрирована: ID корзины
deactivate "Инициатор платежа"
deactivate "Платёжный шлюз"

@enduml